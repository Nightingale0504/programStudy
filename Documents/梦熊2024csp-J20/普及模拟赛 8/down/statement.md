## T1 团结( unite )

### 题目描述

小 C 有一个长度为 $n$ 的序列 $A$。

小 C 认为一个序列 $A$ 是团结的当且仅当 $\gcd(A_1,A_2,...,A_n)=1$。

小 C 现在可以做以下操作任意次：

- 选择一个位置 $i$，将 $A_i$ 变为 $\gcd(A_i,i)$，花费的代价为 $n-i+1$。

小 C 想求出使序列 $A$ 团结的最小代价和。

### 输入格式

输入的第一行包含一个整数 $n$。

接下来一行包含 $n$ 个整数，第 $i$ 个整数表示 $A_i$。

### 输出格式

输出共一行，包含一个整数，表示最小代价和。

### 样例 1 输入

```
2
2 4
```

### 样例 1 输出

```
2
```

### 样例 1 解释

花费代价 $2$ 选择位置 $1$，$A_1$ 变为 $1$。

### 样例 2 输入

```
3
3 6 9
```

### 样例 2 输出

```
2
```

### 其余样例见下发文件。

### 数据规模与约定

- 对于 $30\%$ 的数据，保证 $n\le 20$。

- 对于 $60\%$ 的数据，保证 $n\le 50$。
- 对于 $100\%$ 的数据，$1\le n\le 10^5$，$1\le A_i\le 10^9$。

## T2 染色( color )

### 题目描述

小 C 有一棵大小为 $n$ 且根节点编号为 $1$ 的有根树，节点 $i(i>1)$ 的父亲编号为 $p_i$。

最初该有根树的 $n$ 个节点都没有颜色，小 C 现在要对这棵树进行染色。

小 C 每次可以选择一个点 $u$ 和一个颜色 $x$，将子树 $u$ ( 包括节点 $u$ )中的所有节点都染成颜色 $x$。

小 C 想让第 $i$ 个节点的颜色最后为 $c_i$，他想知道最少要染几次色可以满足上述条件？ 

### 输入格式

输入的第一行包含一个整数 $n$。

第二行包含 $n-1$ 个整数，第 $i$ 个整数表示 $p_{i+1}$。

第三行包含 $n$ 个整数，第 $i$ 个整数表示 $c_i$。

### 输出格式

输出共一行，包含一个整数，表示最少染色次数。

### 样例 1 输入

```
6
1 2 2 1 5
2 1 1 1 1 1
```

### 样例 1 输出

```
3
```

### 样例 2 输入

```
7
1 1 2 3 1 4
3 3 1 1 1 2 3
```

### 样例 2 输出

```
5
```

其余样例见下发文件。

### 数据规模与约定

- 对于 $30\%$ 的数据，保证 $n \le 15$。
- 对于另 $20\%$ 的数据，保证 $\forall 2\le i\le n,p_i=i-1$。
- 对于另 $20\%$ 的数据，保证 $\forall 2\le i\le n,p_i=1$。
- 对于 $100\%$ 的数据，保证 $1 \le n \le 10^{5}$，$1\le c_i\le 10^9$，$1\le p_i\le i-1$。

## T3 三元组( triple )

### 题目描述

小 C 有一个长度为 $n$ 的序列 $A$。

小 C 认为一个三元组 $(i,j,k)(i\ne j,i\ne k,j\ne k)$ 是好的，当且仅当存在正整数 $b$ 满足 $\frac{A_j}{A_i}=\frac{A_k}{A_j}=b$。

小 C 想要知道对于序列 $A$ 而言有多少个**好的**三元组？

### 输入格式

输入的第一行包含一个整数 $n$。

接下来一行包含 $n$ 个整数，第 $i$ 个整数表示 $A_i$。

### 输出格式

输出共一行，包含一个整数，表示好的三元组个数。

### 样例 1 输入

```
3
6 2 18
```

### 样例 1 输出

```
1
```

### 样例 1 解释

只有三元组 $(2,1,3)$ 是好的。

### 样例 2 输入

```
5
1 2 7 7 7
```

### 样例 2 输出

```
6
```

其余样例见下发文件。

### 数据规模与约定

- 对于 $20\%$ 的数据，保证 $n \le 500$。
- 对于 $40\%$ 的数据，保证 $n \le 5000$。
- 对于另 $20\%$ 的数据，保证 $\max A_i \le 5000$。
- 对于另 $20\%$ 的数据，保证 $\max A_i \le 10^6$。
- 对于 $100\%$ 的数据，保证 $1\le n\le 10^5$，$1\le A_i\le 10^{9}$。

## T4 排序( sort )

### 题目描述

小 C 有一个**元素两两不同**的长度为 $n$ 的序列 $A$，但是这个序列可能是无序的。

小 C 不喜欢无序的序列，他现在可以做以下操作任意次：

- 任意选择一个区间 $[l,r]$，花费 $r-l$ 的代价将区间 $[l,r]$ 中的数从小到大排序。

小 C 想用最小的代价和让序列 $A$ 有序( 从小到大 )，但他不仅仅只满足于求出让序列 $A$ 有序的最小代价。

小 C 设 $f_{l,r}$ 表示在只考虑序列 $A$ 的区间 $[l,r]$ 的前提下，让子序列 $[A_l,A_{l+1},...,A_r]$ 有序的最小代价和。

 他想请你求出
$$
\sum_{i=1}^n \sum_{j=i}^n f_{i,j}
$$
的值。

### 输入格式

输入的第一行包含一个整数 $n$。

接下来一行包含 $n$ 个整数，第 $i$ 个整数表示 $A_i$。

### 输出格式

共一行，输出一个整数。

### 样例 1 输入

```
3
3 10 6
```

### 样例 1 输出

```
2
```

### 样例 1 解释

$f_{1,1}=f_{2,2}=f_{3,3}=0$。

$f_{1,2}=0,f_{2,3}=1$。

$f_{1,3}=1$。

### 样例 2 输入

```
5
9 8 2 4 6
```

### 样例 2 输出

```
16
```

其余样例见下发文件。

### 数据规模与约定

- 对于 $20\%$ 的数据，保证 $n\le 5$。
- 对于 $40\%$ 的数据，保证 $n\le 16$。
- 对于 $60\%$ 的数据，保证 $n\le 500$。
- 对于 $80\%$ 的数据，保证 $n\le 5000$。
- 对于 $100\%$ 的数据，保证 $1\le n\le 3\times 10^5$，$1\le A_i\le 10^9$，保证序列 $A$ 中元素两两不同。