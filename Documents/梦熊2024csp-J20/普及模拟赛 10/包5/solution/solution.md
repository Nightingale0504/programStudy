### T1

#### 30 分

暴力枚举即可。

#### 60 分

注意到选定一个 $x$ 后，每次 $p$ 一定是选一个质数，所以最大得分就是 $x$ 的质因子数目，枚举 $x$ 即可。

#### 正解

注意到有一个条件 $2l\le r$，猜测答案就是最大的 $2^t\le r$，实际上这是显然的。

发现至少有 $t$ 个质因子的数是 $2^t$，因为 $\log_2 l+1\le \log_2r$，所以这个 $2^t\ge l$ 肯定成立。

### T2

#### 30 分

暴力即可。

#### 60 分

对每一位滚一个前缀和就好，查询就对每一位查能否为 $1$。

#### 正解

二进制问题就按位做，考虑 $l\sim r$ 中是否存在一个数满足二进制第 $i$ 位为 $1$。

考虑贪心的构造尽量一个大的满足 $\le r$ 的数，那么肯定是找到 $r$ 中第 $j(j>i)$ 位为 $1$ 的位置，把这一位变成 $0$，更高的位不动，第 $j$ 位后面的全部变成 $1$，那么这是一个合法的 $\le r$ 且最大的数，检查其是否 $\ge l$ 即可。

时间复杂度 $\mathcal{O}(T\log_2 r)$。

### T3

#### 20 分

暴力搜索并比较字典序即可。

#### 40 分

显然最长的子序列的长度就是数字种类数。

有一个非常显然的暴力，看选择了一个数后能否取到答案的最大值，如果能取到说明这个数可以选，否则不行，每次在能选的数里面选最大/最小的那一个，暴力实现的话是 $\mathcal{O}(n^3)$。

#### 80 分

考虑优化上述暴力，注意到 check 一个数能不能选就是看一个后缀的数字种类数，这个是容易维护的，可以做到 $\mathcal{O}(n^2)$。

#### 正解

注意到取到答案的最大值的位置组成了一个前缀。

设 $ed_x$ 表示 $x$ 出现的最后一个位置，那么 $1\sim \min_{x\in S}ed_x$ 这个前缀都能取到最大值，这是显然的。

那么就好做了，用 $set$ 维护 $ed_x$ 组成的集合，每次取出最小的一个，每次会询问一个区间 $[l,r]$ 的最小或最大值，因为左右端点右移，可以利用单调队列优化。

### T4

#### 20 分

暴力搜索即可。

#### 40 分

需要挖掘一些性质，注意到可以把 $a$ 分成若干极长子段，每段的元素都相同。

容易知道，每段的元素是什么并不重要，只要知道划分方式就能推出唯一的 $b$。

比较特殊的情况是除了开头的段与结尾的段，如果有长度为 $2$ 的段，其等价于两个长度为 $1$ 的段，对应的 $b$ 都是 `1 1`，于是直接钦定除了开头和结尾不能出现长度为 $2$ 的段。

考虑直接 dp，$dp_{i,j}$ 表示到了 $i$ 划分出了 $j$  段，这样是 $\mathcal{O}(n^3)$。

#### 60 分

注意到划分出 $>k$ 段的方案是等价的，因为只要求 $1\sim k$ 在 $a$ 中都至少出现了一次。

所以第二位只需要 dp 到 $k+1$，这样是 $\mathcal{O}(n^2 k)$。

#### 正解

注意到转移是标准的求一个区间的和，前缀和优化即可。时间复杂度 $\mathcal{O}(nk)$。

