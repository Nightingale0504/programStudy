## T1 染色( paint )

### 题目描述

小 E 同学和他的朋友小 S 在数轴上作画。小 E 同学选择了红色颜料，小 S 选择了蓝色颜料。

小 E 同学先在数轴上画了一笔，然后小 S 也画了一笔。小 E 知晓，当数轴上的某一位置同时被涂上红色和蓝色，最终会呈现出紫色。

现在，他想知道数轴上呈现紫色的长度，你能告诉他吗？

### 输入格式

输入的第一行包含四个整数 $L_1,R_1,L_2,R_2$，分别表示小 E 和小 S 在数轴上涂色的区间。

### 输出格式

输出共一行，包含一个整数，表示数轴上呈现紫色的长度。

### 样例 1 输入

```
0 3 1 5
```

### 样例 1 输出

```
2
```

### 样例 1 解释

小 E 的涂色区间为 $[0,3]$，小 S 的涂色区间为 $[1,5]$，那么二者都涂色的区间为 $[1,3]$，所以紫色的长度为 $2$。

### 样例 2 输入

```
0 1 4 5
```

### 样例 2 输出

```
0
```

### 样例 3 输入

```
0 3 3 7
```

### 样例 3 输出

```
0
```

### 数据规模与约定

- 对于 $20\%$ 的数据，保证 $L_1=L_2,R_1=R_2$。
- 对于另 $20\%$ 的数据，保证数轴上最终不存在紫色。
- 对于另 $20\%$ 的数据，保证 $L_1 < L_2 < R_2 < R_1$。
- 对于 $100\%$ 的数据，保证 $0 \le L_1 < R_1 \le 100,0 \le L_2 < R_2 \le 100$。

## T2 石头称重( stone )

### 题目描述

小 E 有 $n$ 块石头，编号从 $1$ 到 $n$。第 $i$ 号石头的重量是正整数 $w_i$。

对于每一个 $i$，我们保证编号为 $i$ 的石头比所有编号小于 $i$ 的石头的重量总和还要重。

小 E 有时会在使用天平秤称量物体时运用他收集的石头：他将物体放在一个盘子上，将一些石头放在另一个盘子上，如果两个盘子处于平衡状态，他就知道物体的重量与石头组合的重量相同。

当然，并不是所有的物体都可以用上述方法来称重：有时不存在与该物体重量相同的石头组合。

如果可以用一些石头的组合( 可能是空集 )来平衡重量为 $x$ 的物体，则称重量 $x$ 是可接受的。

例如，如果小 E 拥有的石头重量为 $3$ 和 $6$，则可接受的重量有 $0,3,6,9$。

对于给定的 $n$ 块石头，考虑所有不同的可接受重量的严格递增序列，请求出此序列中第 $k$ 个元素的重量是多少。如果不存在第 $k$ 个元素，则输出 $-1$。

### 输入格式

输入的第一行，包含一个正整数 $n$，表示石头的数量。

输入的第二行，包含 $n$ 个正整数，表示每个石头的重量。 

输入的第三行，包含一个正整数，表示题目中所给出的 $k$。 

### 输出格式

输出共一行，包含一个整数，即可接受重量的第 $k$ 个元素，若不存在则输出 $-1$。

### 样例 1 输入

```
2
4 7
1
```

### 样例 1 输出

```
1
```

### 样例 2 输入

```
5
1 3 7 13 30
10
```

### 样例 2 输出

```
14
```



其余样例见下发文件。

### 数据规模与约定

- 对于 $40\%$ 的数据，保证 $n \le 8$。
- 对于另 $30\%$ 的数据，保证 $k \le 1000$。
- 对于 $100\%$ 的数据，保证 $1 \le n \le 50,1 \le k \le 1 \times 10^{18},\sum_{j=1}^{i-1} w_j < w_i,\sum_{i=1}^n w_i \le 10^{18}$。

  

## T3 字符串( string )

### 题目描述

在探索神秘的字符世界的过程中，小 E 遇到了一个有趣的挑战。

他得到了一个长度为 $n$ 的字符串 $s$，这个字符串由一些神秘的问号和小写字母组成。

小 E 觉得这个字符串就像是一把能解开字符世界秘密的钥匙，而那些问号则是等待他去揭开的关键未知元素。

他的任务是通过将问号巧妙地替换为小写字母，来构建一个完美的字符串。但这里有一个严格的规则，那就是在替换完成后的整个字符串中，对于任何一个长度 $\ge 2$ 的连续子串，都不能出现某一个小写字母的数量超过这个连续子串长度的一半。

为了找到所有满足这种苛刻条件的可能性，小 E 希望能知道有多少种可能的替换方式。但由于最终的答案可能非常巨大，需要将答案对 $998244353$ 取余，以便得到一个合理且便于处理的结果。

你能帮帮他吗？

### 输入格式

输入第一行包含一个整数 $n$，表示字符串的长度。

输入第二行包含一个字符串 $s$，表示小 E 获得的字符串。

### 输出格式

输出共一行，表示最少需要使用多少次武器。若不能击败，则输出 $-1$。

### 样例 1 输入

```
3
a?b
```

### 样例 1 输出

```
24
```

### 样例 1 解释

字符串中的问号可以替换为除 $a,b$ 以外任意的小写字母。

### 样例 2 输入

```
3
a?a
```

### 样例 2 输出

```
0
```



其余样例见下发文件。

### 数据规模与约定

- 对于 $30\%$ 的数据，保证 $n \le 8$。
- 对于 $50\%$ 的数据，保证 $n \le 200$。
- 对于另 $10\%$ 的数据，保证字符串中不存在问号。
- 对于 $100\%$ 的数据，保证 $1 \le n \le 5000$。



## T4 喵喵( meow )

### 题目描述

小 E 大抵是一位爱猫人士。

小 E 每天晚上都会摇响铃铛，召集喵喵街 96 号的流浪猫们，向它们投喂食物。可怜的流浪猫们为了尽快获得食物，都会选择最短时间的可能路线前往小 E 所在的位置。

为了方便描述，喵喵街 96 号分为 $n$ 个地点，编号为 $1$ 至 $n$，小 E 的食物投喂点处在点 $1$。不同点之间通过 $m$ 条双向小径连接。每条小径都有一个与之相关的通行时间，并且每个点都能通过一些小径与点 $1$ 联通。

点 $i$ 处有 $c_i$ 只流浪猫，在小 E 摇响铃铛后，这些流浪猫会沿着花费时间最少的路径前往点 $1$，当某两条路径花费时间相同时，它们会选择编号字典序较小的一条( 这里的编号是指点的编号，如路径 $7 \rightarrow 3 \rightarrow 6 \rightarrow 1$ 与 $7 \rightarrow 5 \rightarrow 1$ 两条路径在花费时间相同的前提下，会选择前者 )。容易发现，对于同处点 $i$ 的流浪猫，它们选择的路径相同且唯一。

我们将每只猫到达点 $1$ 所用的最短时间之和成为总时间。为了让流浪猫尽可能少赶路，小 E 希望通过增加一条通行时间为 $t$ 的捷径( 同样为双向路径 )，连接点 $1$ 与一个其它点，来减少总时间。但是由于流浪猫们已经熟悉了原来的路线，当它们在通往 $1$ 号点的常规路径中偶然发现这条捷径，如果它能帮助它们更快地到达$1$ 号点，它们就会选择这条捷径。否则，即使可能使用捷径来改善通行时间，它们也会按照原来的路线行走。

现在，小 E 希望你能帮助他求出增加这条路后能减少总时间的最大值。

### 输入格式

第一行输入三个数字 $n,m,t$，分别表示点数，边数，以及增加的路径的通行时间。

第二行输入 $n$ 个整数 $c_i$，表示点 $i$ 出的流浪猫数量。

接下来 $m$ 行，每行包括三个整数 $a,b,d$，表示一条连接点 $a$ 与点 $b$ 的双向路径，通行时间为 $d$。

### 输出格式

共一行，输出一个整数，表示增加一条路后能减少总时间的最大值。

### 样例 1 输入

```
5 6 2
1 2 3 4 5
1 2 5
1 3 3
2 4 3
3 4 5
4 5 2
3 5 7
```

### 样例 1 输出

```
40
```

### 样例 1 解释

最优方案为再 $1,5$ 之间增加一条通行时间为 $2$ 的捷径。



其余样例见下发文件。

### 数据规模与约定

- 对于 $30\%$ 的数据，保证 $n \le 5$。
- 对于 $50\%$ 的数据，保证 $n \le 500$。
- 对于另 $20\%$ 的数据，保证 $m = n - 1$。
- 对于另 $20\%$ 的数据，保证 $t = 1 \times 10^9$。
- 对于 $100\%$ 的数据，保证 $1 \le n \le 1 \times 10^4, n - 1 \le m \le 5 \times 10^4,1 \le t \le 1 \times 10^9,0\le c_i\le 1 \times 10^4,1\le d \le 2.5 \times 10^4$。